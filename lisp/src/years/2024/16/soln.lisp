(ql:quickload :advent-of-code)

(in-package :cl-user)

(defpackage :advent-of-code/2024/16
  (:use :cl :advent-of-code/utils))

(in-package :advent-of-code/2024/16)

(defun read-input (is-test)
  (let ((grid (make-array 0 :adjustable t :fill-pointer 0)))
    (with-input (path :test is-test)
      (with-open-file (stream path :direction :input)
        (loop for line = (read-line stream nil)
              while line
              do 
              (vector-push-extend (coerce (cl-ppcre:split "" line) 'vector) grid))))
    grid))

(read-input t)

(defun print-grid (grid)
  (loop for row across grid do
        (format t "狺ア蝻鳗┅ㄤ彐篝蝓泗ㄨ遽瘃ê泔铙趄蹉麸泸遽翦桢狃瘵ㄥ戾礤铘磲脲狎蜥卑横潢躞翎忪烘殪飙痫轭翦癌┅ㄤ彐躅桢狃殒躔ㄨ遽殇⑼衢铘衢桢狃痱镳弪豉躔麽蜾徭翦轭箦螋轱睥麒孱殇癌戾舄è疳蝈铘殇ㄦ祜矧ū殇博疳蝈铘屐屙孱ㄡ蝈ㄨ遽瘃屐屙孱趔桢狃疳蝈铘殇┅ㄣ躜蝈铘屐屙孱ㄡ蝈ㄨ遽瘃屐屙孱趔桢狃殇┅麒孱ㄣ狎沲蝌孱舡屐屙孱舂ㄣ狎疳蝈铘屐屙孱舂蝻翎翦ㄡ蝈ㄨ遽瘃屐屙孱趔桢狃殇ㄡ蝈ㄨ遽瘃屐屙孱趔桢狃疳蝈铘殇┅ㄨ遽痖纟躔桢狃疳蝈铘殇┅┅ㄤ彐躅桢狃殒滹黝ㄨ遽殇⑼衢铘衢桢狃痱镳弪豉滹黝麽蜾徭翦蝈盹鲠膦戾舄è戾铉翳戾铉翳ㄨ遽瘃屐屙孱趔桢狃┅戾骠殇ǐí殇博暴蜷玷舡殇ǐí殇博博箜犰戾篝殇┅麒孱ㄡ钿戾骠殇戾铉翳ㄣ狎ㄡ蝈ㄨ遽瘃屐屙孱趔桢狃戾骠殇┅ㄣ狎ㄡ蝈ㄨ遽瘃屐屙孱趔桢狃箜犰戾篝┅┅箦翩箜犰戾篝戾骠殇┅麒孱ㄡ钿蜷玷舡殇戾铉翳ㄣ狎ㄡ蝈ㄨ遽瘃屐屙孱趔桢狃蜷玷舡殇┅ㄣ狎ㄡ蝈ㄨ遽瘃屐屙孱趔桢狃箜犰戾篝┅┅箦翩箜犰戾篝蜷玷舡殇┅麒孱ǒ箜犰戾篝殇蝻翎翦ㄡ蝈ㄨ遽瘃屐屙孱趔桢狃殇ㄡ蝈ㄨ遽瘃屐屙孱趔桢狃箜犰戾篝┅ㄨ遽痖纟滹黝桢狃箜犰戾篝┅┅ㄤ彐躅桢狃瘐箬ㄨ遽痱轱蜷豉轸屙⑿躞犷轸屙鏖翳玳鲥痱轱蜷豉镱麸桢狃鲥泗矧瘐箬屮翦钿ㄣ镱痱轱蜷豉轸屙ㄨ遽瘃屐屙孱趔桢狃┅ㄨ遽痖纟躔桢狃ū戾铉翳ㄨ遽瘃屐屙孱趔桢狃┅┅桢狃ㄤ彐躅桢狃痫ㄨ遽皓⒁屙秭犷蝈趱蝾轸屙鏖翳祜麇篝痱轱蜷豉戾è屐屙孱趔ㄨ遽瘃屐屙孱趔桢狃┅麒孱戾铉翳屐屙孱趔癌ㄥ蝌矧⑷遽轶屙痿┅戾è黹瞽轸屙ㄡ蝈屐屙孱趔癌┅箦翩ㄡ蝈屐屙孱趔癌ㄡ蝈屐屙孱趔ū戾铉翳屐屙孱趔┅┅鲥泗矧痫屐屙孱趔躅戾篌戾铉翳屐屙孱趔癌ㄨ遽痖纟滹黝桢狃癌ㄣ潋黹瞽轸屙┅┅ㄤ彐躅桢狃屙痿ㄨ遽皓⒚桢汶殒桢狃轶屙痿戾铉翳ㄨ遽瘃屐屙孱趔桢狃┅癌ㄤ彐躅骈钿篝狎ㄧ蜷洎⑵轭翳篝狎糸铉痫箝糸镱磲螂邃鏖翳в轭翳珧殇祜镳骘骝镯忮祜戾铉翳珧殇滹祜镳骘骝镯忮祜戾铉翳ㄡ蝈珧殇癌麒孱篝蜷铉ㄡ蝈ㄡ蝈珧殇颟悌⒂蝈趱蝾蝈趱蝾骝镯骈钿篝狎扉篝悌┅铋飑ㄤ彐躅箫祧瀛镱ī⒂镬鲥疳螋镱镦溽倍戾舄è珧殇蝈徜轭瘐铋飑蝻黧戾铉翳珧殇┅ㄣ镬戾铉翳ㄡ蝈珧殇癌┅篝狎ㄦ轭洵篝狎珧殇┅篁ㄦ轵篝篝狎舂筱箦泔钿篝狎舂瘃ㄣ蝈狒瀛桢狃瘵箦孱磲脲栳箬翎忪呼弩＇羼踽飑疳翳铋飑则徙翳疳翳ㄦ矧磲⑶蜷箝搴柳窿ア蝻黧泔祗ㄦ矧磲⒂翎螋狒连俩ア篁筱换深轸獒篝狒搴ㄣ矬潋溷疳翳ㄨ遽瓠瘐箬瘃扉篝篁筱铋飑箦翩ㄧ弭栳箬扉篝篁筱暴箦孱舂祜镳麒殪铒ㄨ遽瓠屙痿瘃┅滹戾舄è沲蝌孱ㄨ遽瓠痫瘃┅ㄣ矬ㄦ轵篝沲蝌孱舂箦泔钿沲蝌孱舂ㄣ翳轵沲蝌孱舂ㄤㄦ秕螋沲蝌孱舂ㄤㄦ殒翳沲蝌孱舂ㄣ躜蝈铘疳翳箝翳沲蝌孱舂┅箦翩ㄧ弭栳箬扉篝潋溷箦孱舂换描邈殒麇蝈徙桢翳孱麒孱篝蜷铉ㄡ蝈ㄡ蝈珧殇颟悌⑴ㄦ矧磲⑵秕钿孱鏖翳溟蝈泗轱连俩ア潋溷ㄦ矧磲⑿狒翎脲詈アㄤ镬轶篝屦蝈鲥蝮ㄣ镱扉篝悌沲蝌孱舡疳翳┅ㄦ矧磲连俩アㄦ轵篝篝屦箦泔钿篝屦┅蝈趱蝾骝镯箫祧瀛镱泔篝┅戾è盹鲥扉篝扉篝ǐ泔篝暴ǐ潋ǐ溷潋溷ㄣ镱扉篝悌沲蝌孱舡疳翳┅篝蜥殓梏扉篝ǐ泔篝卑鞍溷ō潋ㄣ镱扉篝悌沲蝌孱舡疳翳┅沆镢膑轶扉篝ǐ泔篝卑鞍ō溷潋ㄣ镱扉篝悌沲蝌孱舡疳翳┅┅泔躅翦ㄤ镬轶盹鲥盹鲥螬ㄤ弩趄蹉趱蜷铉忾钿铄鳝泔篝铗钽钿钿铄鳝疳翳盹鲥麒孱ㄡ钿铗蝻黧钽泔祗铒篝蜷铉ㄡ蝈ㄡ蝈珧殇铗钽＂┅铒ㄧ弭栳箬扉篝铗钽钿钿悌箦孱┅ㄨ遽瓠瘐箬瘃铄鳝泔篝扉篝铄鳝泔篝铗钽钿钿铄鳝疳翳┅┅┅┅铋飑箫祧瀛镱濠ㄤ彐躅箫祧瀛赭ī⒂镬鲥疳螋赭镦溽倍戾舄è珧殇蝈徜轭瘐铋飑蝻黧戾铉翳珧殇┅ㄣ镬戾铉翳ㄡ蝈珧殇癌┅篝狎ㄦ轭洵篝狎珧殇┅篁ㄦ轵篝篝狎舂筱箦泔钿篝狎舂瘃ㄣ蝈狒瀛桢狃瘵祜麇篝泔篝磲脲栳箬翎忪呼弩＇羼踽飑ㄢ徙媵蜥汶磲脲栳箬翎忪呼弩＇羼踽飑ㄢ弩舡泔篝盹篝痫箝糸鲥骈铛愆ㄥ钿篝狒弩磲脲栳箬翎忪呼弩＇羼踽飑┅换深轸獒扉篝狎糸铉篝狒ㄨ遽瓠瘐箬瘃扉篝篁筱暴箦翩ㄧ弭栳箬扉篝篁筱暴祜麇篝泔篝癌祜镳麒殪铒ㄨ遽瓠屙痿瘃┅滹戾舄è沲蝌孱ㄨ遽瓠痫瘃┅ㄣ矬ㄦ轵篝沲蝌孱舂箦泔钿沲蝌孱舂ㄣ翳轵沲蝌孱舂ㄤㄦ秕螋沲蝌孱舂ㄤㄦ殒翳沲蝌孱舂┅换与轲殒麇鲥骘躅忮趑弪疳翳麸翳轶篝狒麒孱泔篝ㄧ弭栳箬扉篝潋溷祜麇篝泔篝盹篝痫箝糸鲥骈铛愆ㄣ镱糸铛濠换描邈殒麇蝈徙桢翳孱麒孱篝蜷铉ㄡ蝈ㄡ蝈珧殇颟悌⑴麒孱泔篝忮篝泔篝蝈趱蝾┅箦翩忮篝泔篝泔篝箦翩ㄧ弭栳箬扉篝潋溷孱洵篝狒弩舂换清铄蜥翦铄盹鲥戾è盹鲥扉篝换蔑铘轭蹂篝蜥殓梏扉篝ǐ泔篝暴ǐ潋ǐ溷潋溷换怎蝾沆镢膑轶扉篝ǐ泔篝卑鞍溷ō潋┅换怎蝾泔躅翦颦沆镢膑轶扉篝ǐ泔篝卑鞍ō溷潋┅┅ㄤ镬轶盹鲥盹鲥螬ㄤ弩趄蹉趱蜷铉忾钿铄鳝泔篝铗钽钿钿悌盹鲥换与轲麽祆犷秕镦怙躅潴麒孱ㄡ钿铗蝻黧钽泔祗铒篝蜷铉ㄡ蝈ㄡ蝈珧殇铗钽＂┅换描邈殒翳轶轶忮趑弪疳翳戾è祜麇篝ㄧ弭栳箬扉篝铗钽钿钿悌祜麇篝泔篝盹篝痫箝糸鲥骈铛愆┅麒孱冀铄鳝泔篝祜麇篝换涉篝蜷泗禊忮趑弪沆遽痱弼轱躞忉汶趄徙孱趄殄麒孱铄鳝泔篝祜麇篝箦翩ㄧ弭栳箬扉篝铗钽钿钿悌忉汶趄徙氅铋飑箦翩ㄧ弭栳箬扉篝铗钽钿钿悌祜麇篝泔篝铄鳝泔篝┅换龄麸忉汶趄徙磲瘐箬扉篝潋溷ㄧ弭栳箬扉篝铗钽钿钿悌忉汶趄徙氅换龄麸痱轱蜷豉聃艴ㄨ遽瓠瘐箬瘃铄鳝泔篝扉篝铄鳝泔篝铗钽钿钿悌┅┅┅┅换箩汶趄徙麸骈钿犰糸戾轭镳糸磲疳翳戾è篝狒弩磲脲栳箬翎忪呼弩＇羼踽飑聃艴磲脲狎蜥横潢躞翎忪烘殪飙痫轭翦癌┅换深轸獒扉鏖翳孱篝狒弩祜镳骘篝狒忮轭翳栳箬脲镦孱洵篝狒弩滹箦翩ㄧ弭栳箬篝狒篝狒弩舂鲥泗矧瘐箬屮翦钿篝狒聃艴濠换序镢弩聃艴祜镳麒殪戾铉翳聃艴濠癌滹戾è沲蝌孱鲥泗矧痫聃艴濠┅ㄤ镬轶痱弼ㄧ弭栳箬沲蝌孱忉汶趄徙氅躅戾篌ㄧ弭栳箬痱弼篝狒弩箦翩ㄧ弭栳箬痱弼篝狒弩舂鲥泗矧瘐箬屮翦钿痱弼聃艴濠┅┅换蔑躅躅轳蹂颥悌疳轵戾è躅轳蹂糸戾磲脲栳箬翎忪呼弩＇羼踽飑┅祜镳骘蝈篝忮轭翳栳箬脲镦篝狒弩滹箦翩ㄧ弭栳箬扉篝悌躅轳蹂糸戾螬舂ㄨ狍璀翎忪瀛泔躅躅轳蹂糸戾螬┅┅箫祧瀛赭铹